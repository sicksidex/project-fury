<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
    <script>
        var socket = new WebSocket("ws://localhost:8182");
        var currentID = 1;
		var currentSrc;

        socket.onmessage = function (msg) {
            var message = msg.data;
            var package = JSON.parse(message);

            if (package.id = currentID) {
				switch(package.type){
					case "youtube":
						var str = '<div class="framewrap" id="test' + n + '">		<iframe class="frame" width="560" height="315" src="' + package.data + '" frameborder="0" allowfullscreen="0"></iframe><br /><br /></div>';
            			var html = $.parseHTML(str);

            			$('body').append(html);
            			$(".framewrap").resizable()
							.draggable({
								start: function(){
									currentSrc = $(this).find("iframe").attr("src").toString();
									console.log(currentSrc);
					}
					})
					.selectable();
					
				}

            }
        }

        $(function () {
           $("#drop").droppable({
			   drop: function(event,ui){
				   var id = currentID;
				   var type = "youtube";
				   var data = currentSrc;
				   console.log(data);
				   send(id, type, data);
			   }
			   });
        });

        function send(id, type, data) {
            var package = {};

            package.id = id;
            package.type = type;
            package.data = data;
			
			console.log(package);

            var JSONdata = JSON.stringify(package);
            socket.send(JSONdata);
        }
    
        function Close(form)  
        {    
            document.getElementById('.frame').style.display = 'none';
            document.getElementById('.framewrap').style.display = 'none';
        }

        var n = 1;
        
        function test() {
            var str = '<div class="framewrap" id="test' + n + '"><iframe class="frame" width="560" height="315" src="http://www.youtube.com/embed/dGG5GRLYgwM" frameborder="0" allowfullscreen="0"></iframe><br /><br /></div>';
            var html = $.parseHTML(str);

            $('body').append(html);
            $(".framewrap").resizable()
			.draggable({
				start: function(){
					currentSrc = $(this).find("iframe").attr("src").toString();
					console.log(currentSrc);
					}
					})
			.selectable();
        }

    </script>
    <style type="text/css">

.framewrap {
    min-width:560px;        
    width:615px;
    padding-top:10px;
    padding-bottom:10px;
    padding-left:5px;
    padding-right:5px;
    background-color:#B20000;
}
.frame {
    width:500px;
    height:315px;
    background-color:#fff;
    vertical-align:middle;
}

#close {
        vertical-align:top;
        margin-left:0;
}
    </style>
    <link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css" />
</head>
<body>
    <button id="test" onclick="test()">Test</button>
    <div style="background-color:red; width:500px; height:450px;" align="left" id="drop"></div>
     
</body>
</html>